#:kivy 1.11
#:import ASSETS_DIR naturtag.ui.ASSETS_DIR
#:import IMAGE_FILETYPES naturtag.ui.IMAGE_FILETYPES
#:import version naturtag.__version__


<MDIntField@MDTextField>:
	input_filter: 'int'
	helper_text_mode: 'on_focus'


# Main layout and nav drawer
<Controller>:
	orientation: 'vertical'
	md_bg_color: app.theme_cls.primary_color
	adaptive_size: True

	MDToolbar:
		id: toolbar
		title: 'iNaturalist Image Tagger'
		left_action_items: [['menu', lambda x: nav_drawer.set_state('open')]]
		size_hint_max_y: 100

	NavigationLayout:
		title: app.title
		md_bg_color: app.theme_cls.primary_color
		x: toolbar.height

		ScreenManager:
			id: screen_manager

		MDNavigationDrawer:
			id: nav_drawer
			ContentNavigationDrawer:
				screen_manager: screen_manager
				nav_drawer: nav_drawer


# Main nav drawer
<ContentNavigationDrawer@BoxLayout>:
    screen_manager: None
    nav_drawer: None

	BoxLayout:
		orientation: 'vertical'
		FloatLayout:
			size_hint_y: None
			height: "310dp"
			canvas:
				Color:
					rgba: app.theme_cls.bg_normal
				Rectangle:
					pos: self.pos
					size: self.size

			BoxLayout:
				id: top_box
				size_hint_y: None
				height: "300dp"
				x: root.parent.x
				pos_hint: {"top": 1}
				FitImage:
					source: f"{ASSETS_DIR}inat-image-tagger-logo.png"

			MDIconButton:
				icon: "close"
				x: root.parent.x + dp(10)
				pos_hint: {"top": 1}
				on_release: root.parent.set_state('close')

			MDLabel:
				markup: True
				text: f"[b]iNaturalist Image Tagger[/b] Version: {version}"
				x: root.parent.x + dp(10)
				y: root.height - top_box.height
				size_hint_y: None
				height: self.texture_size[1]

		ScrollView:
			MDList:
				OneLineIconListItem:
					text: 'Image Selector'
					on_press:
						root.nav_drawer.set_state('close')
						root.screen_manager.current = 'image_selector'
					IconLeftWidget:
						icon: 'home'
				OneLineIconListItem:
					text: 'Settings'
					on_press:
						root.nav_drawer.set_state('close')
						root.screen_manager.current = 'settings'
					IconLeftWidget:
						icon: 'settings'
				OneLineIconListItem:
					text: 'Exit'
					on_press:
						app.get_running_app().stop()
					IconLeftWidget:
						icon: 'exit-to-app'
