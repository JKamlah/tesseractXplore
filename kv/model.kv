#:import CachedAsyncImage tesseractXplore.widgets.CachedAsyncImage
#:import PLACEHOLDER_ICON tesseractXplore.constants.PLACEHOLDER_ICON
#:import RANKS tesseractXplore.constants.RANKS


<ModelScreen>:
    name: 'model'
    FloatLayout:
        id: layout
        # Right-click context menu for images
        StarredModelContextMenu:
            id: context_menu
            cancel_handler_widget: layout
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                # Model selection: search, history, etc.
                MDTabs:
                    id: model_selection_tabs
                    background_color: app.theme_cls.primary_color
                    size_hint_x: .4
                    size_hint_min_x: dp(500)
                    size_hint_max_x: dp(700)
                    ModelSearchTab:
                        id: search_tab
                    ModelSearchResultsTab:
                        id: search_results_tab
                    ModelHistoryTab:
                        id: history_tab
                    FrequentTaxaTab:
                        id: frequent_tab
                    UserTaxaTab:
                        id: user_tab
                    StarredTaxaTab:
                        id: starred_tab

                # Info display for selected model
                MDBoxLayout:
                    orientation: 'vertical'
                    padding: dp(20)
                    md_bg_color: app.theme_cls.bg_dark
                    MDGridLayout:
                        cols: 2
                        spacing: dp(10)
                        size_hint_y: .7
                        size_hint_min_y: dp(300)
                        size_hint_max_y: dp(650)
                        MDBoxLayout:
                            orientation: 'vertical'
                            spacing: dp(10)
                            size_hint_max_x: dp(500)
                            CachedAsyncImage:
                                id: selected_model_photo
                                size_hint_max_y: dp(500)
                                source: PLACEHOLDER_ICON
                        MDBoxLayout:
                            size_hint_max_x:  dp(500)
                            orientation: 'vertical'
                            ScrollViewY:
                                MDList:
                                    id: basic_info_section
                            LinksSection:
                                id: model_links
                    ModelomySection:
                        id: model_section
            StatusBar:
                id: status_bar

# Model links
<LinksSection@MDBoxLayout>:
    size_hint_max_y: dp(50)
    spacing: dp(10)
    TooltipIconButton:
        id: model_parent_button
        icon: 'arrow-up-circle-outline'
        text: 'View parent'
        width: dp(220)
        disabled: True
    TooltipIconButton:
        id: selected_model_link_button
        icon: 'link-variant'
        text: 'View on iNaturalist'
        width: dp(220)
        disabled: True

# Model ancestors & children
<ModelomySection@MDGridLayout>:
    cols: 2
    # Labels: These will be updated with # of ancestors & children
    OneLineListItem:
        id: model_ancestors_label
        font_style: 'H5'
    OneLineListItem:
        id: model_children_label
        font_style: 'H5'
    # Result lists
    ScrollViewY:
        size_hint_max_x: dp(500)
        MDList:
            id: model_ancestors
    ScrollViewY:
        size_hint_max_x: dp(500)
        MDList:
            id: model_children
